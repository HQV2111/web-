<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <title>Mua Key Hack Game</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
<div class="container mt-5">
  <h2 class="text-center mb-4">Mua Key Hack Game</h2>
  <form id="orderForm">
    <div class="mb-3">
      <label class="form-label">Ch·ªçn game:</label>
      <select class="form-select" id="game">
        <option value="Li√™n Qu√¢n">Li√™n Qu√¢n Mobile</option>
        <option value="PUBG">PUBG Mobile</option>
        <option value="PlayTogether">Play Together VNG</option>
      </select>
    </div>
    <div class="mb-3">
      <label class="form-label">Ch·ªçn th·ªùi h·∫°n:</label>
      <select class="form-select" id="duration">
        <option value="24h">24h - 10.000ƒë</option>
        <option value="7day">7 ng√†y - 35.000ƒë</option>
        <option value="30day">30 ng√†y - 150.000ƒë</option>
      </select>
    </div>
    <div class="mb-3">
      <label class="form-label">T·∫£i ·∫£nh chuy·ªÉn kho·∫£n:</label>
      <input type="file" class="form-control" id="proof" required>
    </div>
    <button type="submit" class="btn btn-primary">X√°c nh·∫≠n thanh to√°n</button>
  </form>

  <div class="mt-4 d-none" id="paymentSection">
    <h4>Th√¥ng tin chuy·ªÉn kho·∫£n</h4>
    <p><strong>S·∫£n ph·∫©m:</strong> <span id="infoProduct"></span></p>
    <p><strong>S·ªë ti·ªÅn:</strong> <span id="infoPrice"></span></p>
    <p><strong>Ng√¢n h√†ng:</strong> MB</p>
    <p><strong>STK:</strong> 07000021112004</p>
    <p><strong>Ch·ªß TK:</strong> HOANG QUOC VIET</p>
    <p><strong>N·ªôi dung CK:</strong> <span id="infoNote"></span></p>
    <button id="getKeyBtn" class="btn btn-success mt-2">L·∫•y Key</button>
  </div>

  <div class="alert alert-info mt-3 d-none text-center" id="keyResult"></div>
</div>

<script>
  const apiURL = "https://script.google.com/macros/s/AKfycbxoJmmyUgNVDrRGhVst6dbTVEWhJOwBPydpUx5sLbz5r3HjHj_f7CNlGLqVAWGlCERz/exec";
  let counter = Math.floor(Math.random() * 1000);

  const priceMap = {
    "24h": "10.000",
    "7day": "35.000",
    "30day": "150.000"
  };

  document.getElementById("orderForm").addEventListener("submit", function (e) {
    e.preventDefault();
    const game = document.getElementById("game").value;
    const duration = document.getElementById("duration").value;

    counter++;
    const transferNote = "NAP" + counter;

    document.getElementById("infoProduct").textContent = `${duration} - ${game}`;
    document.getElementById("infoPrice").textContent = `${priceMap[duration]} VNƒê`;
    document.getElementById("infoNote").textContent = transferNote;
    document.getElementById("paymentSection").classList.remove("d-none");
    window.scrollTo({ top: document.body.scrollHeight, behavior: "smooth" });
  });

  document.getElementById("getKeyBtn").addEventListener("click", async () => {
    const duration = document.getElementById("duration").value;
    const keyBox = document.getElementById("keyResult");

    try {
      const res = await fetch(`${apiURL}?type=xuat&time=${duration}`);
      const data = await res.json();

      if (data.status === "success") {
        keyBox.textContent = `üéâ Key c·ªßa b·∫°n: ${data.key}`;
        keyBox.classList.remove("d-none", "alert-danger");
        keyBox.classList.add("alert-info");
      } else {
        throw new Error(data.message);
      }
    } catch (err) {
      keyBox.textContent = `L·ªói l·∫•y key: ${err.message}`;
      keyBox.classList.remove("d-none", "alert-info");
      keyBox.classList.add("alert-danger");
    }
  });
</script>
</body>
</html>
