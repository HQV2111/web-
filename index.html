<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Mua Key Hack Game</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet"/>
</head>
<body class="bg-light">
  <div class="container py-5">
    <h1 class="text-center mb-4">Mua Key Hack Game</h1>
    <form id="orderForm" class="bg-white p-4 rounded shadow-sm">
      <div class="mb-3">
        <label for="game" class="form-label">Ch·ªçn game</label>
        <select name="game" id="game" class="form-select" required>
          <option value="lienquan">Li√™n Qu√¢n Mobile</option>
          <option value="pubg">PUBG Mobile</option>
          <option value="playtogether">Play Together VNG</option>
        </select>
      </div>
      <div class="mb-3">
        <label for="duration" class="form-label">Ch·ªçn th·ªùi h·∫°n key</label>
        <select name="duration" id="duration" class="form-select" required>
          <option value="24h">24h - 10.000ƒë</option>
          <option value="7day">7 ng√†y - 35.000ƒë</option>
          <option value="30day">30 ng√†y - 150.000ƒë</option>
        </select>
      </div>
      <div class="mb-3">
        <label for="proof" class="form-label">T·∫£i ·∫£nh x√°c nh·∫≠n chuy·ªÉn kho·∫£n</label>
        <input type="file" name="proof" id="proof" class="form-control" required />
      </div>
      <button type="submit" class="btn btn-primary w-100">X√°c nh·∫≠n thanh to√°n</button>
    </form>

    <div id="paymentInfo" class="mt-4 d-none">
      <div class="card p-3">
        <h5>Th√¥ng tin chuy·ªÉn kho·∫£n</h5>
        <div class="payment-info">
          <p><strong>S·∫£n ph·∫©m:</strong> <span id="summaryProduct"></span></p>
          <p><strong>STK:</strong> 999999999999999</p>
          <p><strong>S·ªë ti·ªÅn:</strong> <span id="summaryPrice"></span> VNƒê</p>
          <p><strong>N·ªôi dung chuy·ªÉn kho·∫£n:</strong> <span id="transferNote"></span></p>
        </div>
        <button id="getKeyBtn" class="btn btn-success mt-3">L·∫•y Key</button>
      </div>
    </div>

    <div id="keyResult" class="alert alert-info mt-4 d-none text-center"></div>
  </div>

  <script>
    const apiURL = "https://script.google.com/macros/s/AKfycbw1au3_eVXFDjSG250gS1wT5M82416FDH0gserZ1ArIXqwb56WOYEq6IM1QuHJCBu8W/exec";
    let transferCounter = Math.floor(Math.random() * 10000); // random ƒë·ªÉ gi·∫£ l·∫≠p
    const priceMap = {
      "24h": "10.000",
      "7day": "35.000",
      "30day": "150.000"
    };

    document.getElementById("orderForm").addEventListener("submit", function(e) {
      e.preventDefault();
      const form = new FormData(e.target);
      const game = form.get("game");
      const duration = form.get("duration");

      const gameMap = {
        "lienquan": "Li√™n Qu√¢n Mobile",
        "pubg": "PUBG Mobile",
        "playtogether": "Play Together VNG"
      };

      const durationMap = {
        "24h": "24 gi·ªù",
        "7day": "7 ng√†y",
        "30day": "30 ng√†y"
      };

      transferCounter++;
      const transferCode = "NAP" + transferCounter;
      const price = priceMap[duration];

      document.getElementById("summaryProduct").innerText = `${durationMap[duration]} | ${gameMap[game]}`;
      document.getElementById("transferNote").innerText = transferCode;
      document.getElementById("summaryPrice").innerText = price;

      document.getElementById("paymentInfo").classList.remove("d-none");
      window.scrollTo({ top: document.body.scrollHeight, behavior: "smooth" });
    });

    document.getElementById("getKeyBtn").addEventListener("click", async () => {
      const duration = document.getElementById("duration").value;

      try {
        const res = await fetch(`${apiURL}?type=xuat&time=${duration}`);
        const data = await res.json();

        if (data.status === "success") {
          document.getElementById("keyResult").classList.remove("d-none");
          document.getElementById("keyResult").innerText = `üéâ Key c·ªßa b·∫°n: ${data.key}`;
        } else {
          throw new Error(data.message || "Kh√¥ng l·∫•y ƒë∆∞·ª£c key");
        }
      } catch (err) {
        document.getElementById("keyResult").classList.remove("d-none");
        document.getElementById("keyResult").classList.replace("alert-info", "alert-danger");
        document.getElementById("keyResult").innerText = `L·ªói l·∫•y key: ${err.message}`;
      }
    });
  </script>
</body>
</html>
